{
    "comment": "DuckDB-first MIMIC-IV -> OMOP CDM v5.4 workflow",
    "variables": {
        "@duckdb_path": "data/mimiciv_demo.duckdb",
        "@mimic_hosp_dir": "data/physionet.org/files/mimic-iv-demo/2.2/hosp",
        "@mimic_icu_dir": "data/physionet.org/files/mimic-iv-demo/2.2/icu",
        "@mimic_derived_dir": "data/physionet.org/files/mimic-iv-demo/2.2/derived",
        "@mimic_waveform_dir": "",

        "@source_project": "@duckdb_catalog",
        "@hosp_dataset": "raw_hosp",
        "@icu_dataset": "raw_icu",

        "@etl_project": "@duckdb_catalog",
        "@etl_dataset": "omop_cdm",
        "@cdm_schema": "omop_cdm",
        "@omop_schema": "omop",
        "@audit_schema": "audit",
        "@custom_mapping_dir": "custom_mapping_csv",
        "@crosswalk_dir": "crosswalk_csv",
        "@waveform_dataset": "raw_waveform",
        "@audit_min_percent_mapped": "0",
        "@audit_min_percent_standard": "0",
        "@ingest_manifest": "fail",
        "@ingest_sample_size": "100000",
        "@ingest_include_tables": "patients,admissions,transfers,diagnoses_icd,services,labevents,d_labitems,procedures_icd,hcpcsevents,drgcodes,prescriptions,microbiologyevents,pharmacy,d_items,chartevents,datetimeevents,outputevents,procedureevents",

        "@vocab_db_path": "data/vocab.duckdb",
        "@vocab_schema": "main",
        "@voc_project": "vocab",
        "@voc_dataset": "main",
        "@wf_project": "@duckdb_catalog",
        "@wf_dataset": "raw_waveform",
        "@athena_export_path": "athena_export",
        "@publish_materialize": "0"
        ,
        "@optimize_enable": "0",
        "@optimize_enable_large": "0"
    },
    "duckdb": {
        "database": "@duckdb_path",
        "attachments": [
            {"path": "@vocab_db_path", "alias": "vocab", "read_only": true}
        ],
        "pre_sql": ["etl/duckdb/macros.sql"]
    },
    "workflows": [
        {"workflow": "ingest_csv", "type": "py", "conf": "workflow_ingest_csv.conf"},
        {"workflow": "vocabulary_refresh", "type": "py", "conf": "workflow_vocabulary_refresh.conf"},
        {"workflow": "ddl", "type": "sql", "conf": "workflow_ddl.conf"},
        {"workflow": "staging", "type": "sql", "conf": "workflow_staging.conf"},
        {"workflow": "optimize", "type": "py", "conf": "workflow_optimize.conf"},
        {"workflow": "custom_mapping", "type": "py", "conf": "workflow_custom_mapping.conf"},
        {"workflow": "etl", "type": "sql", "conf": "workflow_etl.conf"},
        {"workflow": "publish", "type": "sql", "conf": "workflow_publish.conf"},
        {"workflow": "materialize", "type": "py", "conf": "workflow_materialize.conf"},
        {"workflow": "audit", "type": "sql", "conf": "workflow_audit.conf"}
    ]
}
